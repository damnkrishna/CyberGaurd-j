# Shodan.io 

##  Introduction

* **Shodan.io** = "Search Engine for the Internet of Things".
* Unlike Google, which indexes web pages, Shodan indexes **devices, services, and their banners**.
* Helps find:

  * Misconfigured devices
  * Exposed services (FTP, RDP, SSH, databases, etc.)
  * ICS/SCADA systems
  * IoT devices (cameras, routers, etc.)
  * Potential attack surfaces

---

## üîë Key Concepts

### 1. **Banners**

* A *banner* = metadata about a service/device (software version, open ports, server headers, etc.).
* Shodan collects banners from devices exposed to the internet.
* Example banner info:

  * Software version (Apache 2.4.49)
  * Service type (FTP, RDP, MongoDB)
  * Location, ISP, Organization

### 2. **Basic Searching**

* Syntax:

  ```
  <keyword>
  ```

  Example:

  ```
  apache
  nginx
  webcam
  ```
* Returns all banners that contain that keyword.

### 3. **Filters**

Shodan supports **filters** to narrow results. Some useful ones:

* `port:` ‚Üí filter by open port

  ```
  apache port:80
  ```
* `org:` ‚Üí filter by organization

  ```
  org:"Google"
  ```
* `country:` ‚Üí filter by country (2-letter code)

  ```
  apache country:"IN"
  ```
* `city:` ‚Üí filter by city

  ```
  mysql city:"New York"
  ```
* `os:` ‚Üí filter by operating system

  ```
  os:"Windows 7"
  ```
* `before:` and `after:` ‚Üí filter by time

  ```
  nginx before:01/01/2022
  ```
* `ssl:` ‚Üí filter SSL certificate details

  ```
  ssl:"Let's Encrypt"
  ```
* `hostname:` ‚Üí filter by hostname/domain

  ```
  hostname:"tryhackme.com"
  ```
* `net:` ‚Üí search within specific IP range

  ```
  net:192.168.1.0/24
  ```

### 4. **Exposed Devices to Look For**

* **Cameras** ‚Üí `webcamXP`, `port:554`, `has_screenshot:true`
* **RDP** ‚Üí `port:3389`
* **FTP** ‚Üí `port:21 Anonymous`
* **MongoDB/ElasticSearch** (common misconfigs) ‚Üí

  ```
  product:MongoDB port:27017
  product:ElasticSearch port:9200
  ```
* **SCADA/ICS** ‚Üí

  ```
  port:502 product:modbus
  port:102 product:Siemens
  ```
* **Printers / Routers** ‚Üí `HP JetDirect`, `port:9100`

---

## üõ† Practical Usage (as covered in THM room)

1. **Finding open RDP servers in India**

   ```
   port:3389 country:IN
   ```

2. **Detecting cameras**

   ```
   has_screenshot:true
   ```

   or

   ```
   product:"webcamXP"
   ```

3. **Search by Organization**

   ```
   org:"Microsoft"
   ```

4. **Search for default/weakly configured services**

   ```
   "default password"
   "Server: Apache/2.2.3 (CentOS)"
   ```

---

## ‚ö†Ô∏è Security Implications

* Shodan is **not inherently malicious** ‚Üí it‚Äôs just a search engine.
* Attackers use it to find vulnerable systems.
* Defenders use it for **threat intelligence & exposure analysis**.

---

## üë®‚Äçüíª CLI Usage

Install:

```
pip install shodan
```

Initialize with API key:

```
shodan init <APIKEY>
```

Basic searches:

```
shodan search apache
shodan search port:21 Anonymous
shodan search org:"Tesla"
```

Host lookup:

```
shodan host <IP>
```

Count results:

```
shodan count <query>
```

---

## üìö Summary

* **Shodan indexes devices, not websites.**
* **Banners** reveal a lot of sensitive info.
* **Filters** are powerful ‚Üí narrow down targets.
* Can be used for **OSINT, red teaming, or blue teaming**.
* TryHackMe teaches how attackers could misuse it ‚Üí **defenders should know what‚Äôs exposed**.
